### 注册中心有哪些

Eureka -  Netflix开源的一个组件

Zookeeper - apach开源的一个组件，Dubbo的注册中心依赖。

Consul - go语言开发的一个开源组件

Nacos - 阿里开发的一个开源组件

### 各节点关系

当注册中心有多个时，各个服务中心之间的关系主要有两种，一种是平级，一种是主从，平级是指各个节点之间的关系都是独立的，主从是指各个节点之间存在主节点和从节点，节点之间存在上下级的关系。

Eureka - 平级关系

Zookeeper 、 Consul - 主从关系

Nacos - 支持平级和主从



### 健康检查与自动注销

大部分注册中心都使用ttl（time to live）心跳的健康检查机制，即每隔N的间隔，客户端会向注册中心发送心跳。

当发送心跳的间隔超过了指定的时间，则注册中心会将服务从服务列表中剔除。

除了Consul不支持服务自动注销以外（可以搭配fabio实现），其他几个注册中心都支持服务的自动注销。

#### 雪崩保护

当某个注册中心注册的健康检查失败的服务超过一个阈值时，为了让服务正常使用，注册中心会进入保护模式，此模式下，注册中心不再将信息同步至其他节点，同时也不会让服务因为健康检查失败而注销，大大的提高了可用性。

Eureka和Nacos支持，Zk和Consul不支持。



### CAP

[CAP定理](https://zh.wikipedia.org/wiki/CAP%E5%AE%9A%E7%90%86)是描述一个系统在运行时，对于可用性、一致性、容灾性三个方面的一个定理，系统在同一时间只能满足其中的两个，而P（容灾性）最为关键，因此大部分系统都是满足CP或者AP。在注册中心这一类系统中，可用性是指当注册中心down掉或者与其他注册中心失联时，是否能够继续使用的情况，一致性是指注册的服务发生变动了，是否会因为没有同步到其他注册中心导致服务无法使用，或者当多个注册中心的注册信息不相同时，是否能够容忍。

Eureka - AP

ZK - CP

Consul - CP

Nacos - AP和CP都支持，可以在配置中修改。







