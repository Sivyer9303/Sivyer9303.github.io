## Redis数据结构

### SDS

sds是String类型的承载数据结构，同时也是Key的承载数据结构。

#### 结构构成

sds结构由三个部分组成。

free - 标识sds对象中未使用的空间。

len - 标识sds对象中已使用的空间。

buf - 字符数组，用来存储内容，以\0结尾。

如此设计的意义：

1.将获取字符长度的复杂度变成O（1）

2.能够在内存重分配时提高速度，通过添加free字段，在进行扩容或者修改时，能够很快的获知是否需要重分配。

#### 空间预分配

空间预分配用于优化SDS的字符串增长操作：当SDS的API对一个SDS进行修改，并且需要对SDS进行空间扩展的时候，程序不仅会为SDS分配修改所必须要的空间，还会为SDS分配额外的未使用空间。

额外分配的空间，将根据修改后的长度来决定，如果修改后的长度小于1M，那么预分配的空间等于修改后的长度，此时free = len；若修改后的长度大于1M，那么预分配的空间将等于1M。

#### 惰性空间释放

当对SDS字符串进行缩短的操作时，那么Redis并不会马上释放掉未使用的内存空间，而是使用free字段进行标明，避免后续再度因为扩容而导致了重新分配。



### 链表

链表作为列表键的主要实现手段，提供了高效的访问效率。

#### 结构构成

List结构主要由以下三个部分构成。

head - 头节点，结构类型为ListNode

tail - 尾节点，结构类型为ListNode

len - list的长度

list还包含了一些方法，用于复制list、释放list等



ListNode结构主要由三部分构成

preNode - 上一个节点

nextNode - 下一个节点

value - 节点的值



可以看出，链表是双向链表，且保存了头尾节点和长度，那么在获取头尾节点和链表长度时，复杂度都为O（1）。



### 字典

1

